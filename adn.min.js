(function(){this.ADN={}}).call(this),function(){"use strict";function t(t,e){this.message=t,this.status=e}function e(e,n,r){var o=new XMLHttpRequest;o.open(e.method||"GET",e.url,!0),e.credentials&&(o.withCredentials=!0),Object.keys(e.headers||{}).forEach(function(t){o.setRequestHeader(t,e.headers[t])}),o.onload=function(e){-1===[200,304,0].indexOf(o.status)?r(new t("Server responded with a status of "+o.status,o.status)):n(e.target)},o.send(e.data||void 0)}t.prototype=Error(),t.prototype.constructor=t,Object.defineProperty(ADN,"xhr",{value:e}),Object.defineProperty(ADN,"XhrError",{value:t})}(),function(){"use strict";function t(t,e){this.clientID=t,this.redirectURI=e}var e="https://alpha.app.net/oauth/authorize";t.prototype={authenticate:function(){window.location=this.getUri()},clearToken:function(){localStorage.removeItem("accessToken")},getUri:function(){return e+"?client_id="+this.clientID+"&response_type=token"+"&redirect_uri="+this.redirectURI+"&scope=write_post,follow,messages,stream"},hasAccessToken:function(){return localStorage.accessToken!==void 0&&null!==localStorage.accessToken},hasRedirected:function(){var t=window.location.hash.substr(1).split("access_token=")[1];return t?(localStorage.accessToken=t,window.location=this.redirectURI,!0):!1},isAuthenticated:function(){return this.hasAccessToken()||this.hasRedirected()}},Object.defineProperty(ADN,"Authenticator",{value:t})}(),function(){"use strict";function t(){var t=Array.prototype.slice.call(arguments),e="",n=t[0];return t.splice(0,1),e=n,t.forEach(function(t,n){var r=""+t;e=e.replace("{"+n+"}",r)}),e}function e(t){this.format=t,this.urlParameters=[],this.queryParameters=[]}var n="https://alpha-api.app.net/stream/0/";e.prototype={addQueryParameter:function(t,e){this.queryParameters.push([t,e])},addUrlParameter:function(t){this.urlParameters.push(t)},buildUrl:function(){var e=n+this.format;if(this.urlParameters.length>0){var r=this.urlParameters.slice(0);r.unshift(e),e=t.apply(null,r)}return 0===this.queryParameters.length?e:(this.queryParameters.forEach(function(t,n){var r=0===n?"?":"&";e+=r+t[0]+"="+t[1]}),e)},reset:function(){this.queryParameters=[],this.urlParameters=[]}},Object.defineProperty(ADN,"Endpoint",{value:e})}(),function(){"use strict";function t(){}t.prototype={sendRequest:function(t,e,n){t=t||{},t.url=(t.endpoint||this.endpoint).buildUrl(),t.headers=t.headers||{},t.headers.Authorization="Bearer "+localStorage.accessToken,t.headers.Accept="application/json",this.endpoint.reset(),ADN.xhr(t,function(t){if(t&&t.responseText){var n=JSON.parse(t.responseText);e(n.data||n)}else e()},function(t){if(t instanceof ADN.XhrError&&401===t.status){var e=new ADN.Authenticator;e.clearToken(),e.authenticate()}(n||function(){})(t)})}},Object.defineProperty(ADN,"Access",{value:t})}(),function(){"use strict";function t(){ADN.Access.apply(this,arguments)}t.prototype=Object.create(ADN.Access.prototype),t.prototype.setOldestPostId=function(t){t&&t.length>0&&(this.oldestPostId=t[t.length-1].id)},t.prototype.setNewestPostId=function(t){t&&t.length>0&&(this.newestPostId=t[0].id)},t.prototype.fetchNew=function(t,e){if(this.newestPostId)this.endpoint.addQueryParameter("min_id",this.newestPostId);else var n=!0;var r=this;this.retrieve(function(e){e.sort(function(t,e){return t.id<e.id?1:-1}),r.setNewestPostId(e),n&&r.setOldestPostId(e),t(e)},e)},t.prototype.fetchMore=function(t,e){if(this.oldestPostId){var n=this;this.endpoint.addQueryParameter("max_id",this.oldestPostId),this.retrieve(function(e){e.sort(function(t,e){return t.id<e.id?1:-1}),n.setOldestPostId(e),t(e)},e)}},t.prototype.retrieve=function(t,e){var n=this;this.sendRequest(null,function(e){t.call(n,e)},e)},Object.defineProperty(ADN,"Stream",{value:t})}(),function(){"use strict";function t(){ADN.Stream.apply(this,arguments),this.endpoint=new ADN.Endpoint("posts/stream")}t.prototype=Object.create(ADN.Stream.prototype),Object.defineProperty(ADN,"Feed",{value:t})}(),function(){"use strict";function t(){ADN.Stream.apply(this,arguments),this.endpoint=new ADN.Endpoint("users/me/mentions")}t.prototype=Object.create(ADN.Stream.prototype),Object.defineProperty(ADN,"Mentions",{value:t})}(),function(){"use strict";function t(){ADN.Stream.apply(this,arguments),this.endpoint=new ADN.Endpoint("posts/stream/global")}t.prototype=Object.create(ADN.Stream.prototype),Object.defineProperty(ADN,"Global",{value:t})}(),function(){"use strict";function t(t){ADN.Stream.apply(this,arguments),this.endpoint=new ADN.Endpoint("users/"+t+"/posts")}t.prototype=Object.create(ADN.Stream.prototype),Object.defineProperty(ADN,"UserStream",{value:t})}(),function(){"use strict";function t(){this.endpoint=new ADN.Endpoint("users/{0}"),this.followEndpoint=new ADN.Endpoint("users/{0}/follow"),this.muteEndpoint=new ADN.Endpoint("users/{0}/mute")}t.prototype=Object.create(ADN.Access.prototype),t.prototype.retrieve=function(t,e,n){this.endpoint.addUrlParameter(t),this.sendRequest(null,e,n)},t.prototype.endpointCall=function(t,e,n,r,o){e.addUrlParameter(t);var s={endpoint:e,method:n,credentials:!0};this.sendRequest(s,r,o)},t.prototype.follow=function(t,e,n){this.endpointCall(t,this.followEndpoint,"POST",e,n)},t.prototype.unfollow=function(t,e,n){this.endpointCall(t,this.followEndpoint,"DELETE",e,n)},t.prototype.mute=function(t,e,n){this.endpointCall(t,this.muteEndpoint,"POST",e,n)},t.prototype.unmute=function(t,e,n){this.endpointCall(t,this.muteEndpoint,"DELETE",e,n)},Object.defineProperty(ADN,"User",{value:t})}(),function(){"use strict";function t(t){ADN.Access.apply(this,arguments),this.id=t,this.endpoint=new ADN.Endpoint("posts/{0}"),this.createEndpoint=new ADN.Endpoint("posts")}t.prototype=Object.create(ADN.Access.prototype),t.prototype.deletePost=function(t,e,n){t=t||this.id,this.endpoint.addUrlParameter(t);var r={method:"DELETE",credentials:!0};this.sendRequest(r,function(t){t?e():n()},n)},t.prototype.postMessage=function(t,e,n){var r={headers:{"Content-Type":"application/x-www-form-urlencoded"},endpoint:this.createEndpoint,method:"POST",data:t,credentials:!1};this.sendRequest(r,e,n)},t.prototype.retrieve=function(t,e){this.endpoint.addUrlParameter(this.id),this.sendRequest(null,t,e)},t.sort=function(t,e){return(t||[]).sort(function(t,n){var r=Date.parse(t.created_at),o=Date.parse(n.created_at);return e(r,o)?1:-1})},t.sortAscending=function(t){return this.sort(t,function(t,e){return t>e})},t.sortDescending=function(t){return this.sort(t,function(t,e){return e>t})},Object.defineProperty(ADN,"Post",{value:t})}(),function(){"use strict";function t(t){ADN.Access.apply(this,arguments),this.postId=t,this.endpoint=new ADN.Endpoint("posts/{0}/replies")}t.prototype=Object.create(ADN.Access.prototype),t.prototype.retrieve=function(t,e){this.endpoint.addUrlParameter(this.postId),this.sendRequest(null,t,e)},Object.defineProperty(ADN,"Replies",{value:t})}(),function(){"use strict";function t(t){ADN.Stream.apply(this,arguments),this.endpoint=new ADN.Endpoint("posts/tag/"+t)}t.prototype=Object.create(ADN.Stream.prototype),Object.defineProperty(ADN,"Hashtag",{value:t})}();